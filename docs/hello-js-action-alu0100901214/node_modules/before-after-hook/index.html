<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>before-after-hook | hello-js-action-super-alu0100901214</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="before-after-hook" />
<meta property="og:locale" content="en_US" />
<meta property="og:site_name" content="hello-js-action-super-alu0100901214" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="before-after-hook" />
<script type="application/ld+json">
{"@type":"WebPage","headline":"before-after-hook","url":"/hello-js-action-alu0100901214/node_modules/before-after-hook/","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=b2af5f6ea41af3602f1a9c47b537e7eb2066fd0d">
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <script src="/assets/js/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="/assets/css/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/ULL-ESIT-PL-2021/hello-js-action-super-alu0100901214">View On GitHub</a></li>
          
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>hello-js-action-super-alu0100901214</h1>
          <p></p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/ULL-ESIT-PL-2021">ULL-ESIT-PL-2021</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

        <h1 id="before-after-hook">before-after-hook</h1>

<blockquote>
  <p>asynchronous hooks for internal functionality</p>
</blockquote>

<p><a href="https://www.npmjs.com/package/before-after-hook"><img src="https://img.shields.io/npm/dw/before-after-hook.svg" alt="npm downloads" /></a>
<a href="https://travis-ci.org/gr2m/before-after-hook"><img src="https://travis-ci.org/gr2m/before-after-hook.svg?branch=master" alt="Build Status" /></a>
<a href="https://coveralls.io/r/gr2m/before-after-hook?branch=master"><img src="https://coveralls.io/repos/gr2m/before-after-hook/badge.svg?branch=master" alt="Coverage Status" /></a>
<a href="https://greenkeeper.io/"><img src="https://badges.greenkeeper.io/gr2m/before-after-hook.svg" alt="Greenkeeper badge" /></a></p>

<h2 id="usage">Usage</h2>

<h3 id="singular-hook">Singular hook</h3>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// instantiate singular hook API</span>
<span class="kd">const</span> <span class="nx">hook</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hook</span><span class="p">.</span><span class="nx">Singular</span><span class="p">();</span>

<span class="c1">// Create a hook</span>
<span class="kd">function</span> <span class="nx">getData</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">hook</span><span class="p">(</span><span class="nx">fetchFromDatabase</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">handleData</span><span class="p">)</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">handleGetError</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// register before/error/after hooks.</span>
<span class="c1">// The methods can be async or return a promise</span>
<span class="nx">hook</span><span class="p">.</span><span class="nx">before</span><span class="p">(</span><span class="nx">beforeHook</span><span class="p">);</span>
<span class="nx">hook</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">errorHook</span><span class="p">);</span>
<span class="nx">hook</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="nx">afterHook</span><span class="p">);</span>

<span class="nx">getData</span><span class="p">({</span> <span class="na">id</span><span class="p">:</span> <span class="mi">123</span> <span class="p">});</span>
</code></pre></div></div>

<h3 id="hook-collection">Hook collection</h3>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// instantiate hook collection API</span>
<span class="kd">const</span> <span class="nx">hookCollection</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hook</span><span class="p">.</span><span class="nx">Collection</span><span class="p">();</span>

<span class="c1">// Create a hook</span>
<span class="kd">function</span> <span class="nx">getData</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">hookCollection</span><span class="p">(</span><span class="dl">"</span><span class="s2">get</span><span class="dl">"</span><span class="p">,</span> <span class="nx">fetchFromDatabase</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">handleData</span><span class="p">)</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">handleGetError</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// register before/error/after hooks.</span>
<span class="c1">// The methods can be async or return a promise</span>
<span class="nx">hookCollection</span><span class="p">.</span><span class="nx">before</span><span class="p">(</span><span class="dl">"</span><span class="s2">get</span><span class="dl">"</span><span class="p">,</span> <span class="nx">beforeHook</span><span class="p">);</span>
<span class="nx">hookCollection</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">"</span><span class="s2">get</span><span class="dl">"</span><span class="p">,</span> <span class="nx">errorHook</span><span class="p">);</span>
<span class="nx">hookCollection</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="dl">"</span><span class="s2">get</span><span class="dl">"</span><span class="p">,</span> <span class="nx">afterHook</span><span class="p">);</span>

<span class="nx">getData</span><span class="p">({</span> <span class="na">id</span><span class="p">:</span> <span class="mi">123</span> <span class="p">});</span>
</code></pre></div></div>

<h3 id="hooksingular-vs-hookcollection">Hook.Singular vs Hook.Collection</h3>

<p>There’s no fundamental difference between the <code class="language-plaintext highlighter-rouge">Hook.Singular</code> and <code class="language-plaintext highlighter-rouge">Hook.Collection</code> hooks except for the fact that a hook from a collection requires you to pass along the name. Therefore the following explanation applies to both code snippets as described above.</p>

<p>The methods are executed in the following order</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">beforeHook</code></li>
  <li><code class="language-plaintext highlighter-rouge">fetchFromDatabase</code></li>
  <li><code class="language-plaintext highlighter-rouge">afterHook</code></li>
  <li><code class="language-plaintext highlighter-rouge">getData</code></li>
</ol>

<p><code class="language-plaintext highlighter-rouge">beforeHook</code> can mutate <code class="language-plaintext highlighter-rouge">options</code> before it’s passed to <code class="language-plaintext highlighter-rouge">fetchFromDatabase</code>.</p>

<p>If an error is thrown in <code class="language-plaintext highlighter-rouge">beforeHook</code> or <code class="language-plaintext highlighter-rouge">fetchFromDatabase</code> then <code class="language-plaintext highlighter-rouge">errorHook</code> is
called next.</p>

<p>If <code class="language-plaintext highlighter-rouge">afterHook</code> throws an error then <code class="language-plaintext highlighter-rouge">handleGetError</code> is called instead
of <code class="language-plaintext highlighter-rouge">getData</code>.</p>

<p>If <code class="language-plaintext highlighter-rouge">errorHook</code> throws an error then <code class="language-plaintext highlighter-rouge">handleGetError</code> is called next, otherwise
<code class="language-plaintext highlighter-rouge">afterHook</code> and <code class="language-plaintext highlighter-rouge">getData</code>.</p>

<p>You can also use <code class="language-plaintext highlighter-rouge">hook.wrap</code> to achieve the same thing as shown above (collection example):</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">hookCollection</span><span class="p">.</span><span class="nx">wrap</span><span class="p">(</span><span class="dl">"</span><span class="s2">get</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">getData</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">await</span> <span class="nx">beforeHook</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">getData</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">await</span> <span class="nx">errorHook</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">await</span> <span class="nx">afterHook</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<h2 id="install">Install</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm install before-after-hook
</code></pre></div></div>

<p>Or download <a href="https://github.com/gr2m/before-after-hook/releases/latest">the latest <code class="language-plaintext highlighter-rouge">before-after-hook.min.js</code></a>.</p>

<h2 id="api">API</h2>

<ul>
  <li><a href="#singular-hook-api">Singular Hook Constructor</a></li>
  <li><a href="#hook-collection-api">Hook Collection Constructor</a></li>
</ul>

<h2 id="singular-hook-api">Singular hook API</h2>

<ul>
  <li><a href="#singular-constructor">Singular constructor</a></li>
  <li><a href="#singular-api">hook.api</a></li>
  <li><a href="#singular-api">hook()</a></li>
  <li><a href="#singular-api">hook.before()</a></li>
  <li><a href="#singular-api">hook.error()</a></li>
  <li><a href="#singular-api">hook.after()</a></li>
  <li><a href="#singular-api">hook.wrap()</a></li>
  <li><a href="#singular-api">hook.remove()</a></li>
</ul>

<h3 id="singular-constructor">Singular constructor</h3>

<p>The <code class="language-plaintext highlighter-rouge">Hook.Singular</code> constructor has no options and returns a <code class="language-plaintext highlighter-rouge">hook</code> instance with the
methods below:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">hook</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hook</span><span class="p">.</span><span class="nx">Singular</span><span class="p">();</span>
</code></pre></div></div>

<p>Using the singular hook is recommended for <a href="#typescript">TypeScript</a></p>

<h3 id="singular-api">Singular API</h3>

<p>The singular hook is a reference to a single hook. This means that there’s no need to pass along any identifier (such as a <code class="language-plaintext highlighter-rouge">name</code> as can be seen in the <a href="#hookcollectionapi">Hook.Collection API</a>).</p>

<p>The API of a singular hook is exactly the same as a collection hook and we therefore suggest you read the <a href="#hookcollectionapi">Hook.Collection API</a> and leave out any use of the <code class="language-plaintext highlighter-rouge">name</code> argument. Just skip it like described in this example:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">hook</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hook</span><span class="p">.</span><span class="nx">Singular</span><span class="p">();</span>

<span class="c1">// good</span>
<span class="nx">hook</span><span class="p">.</span><span class="nx">before</span><span class="p">(</span><span class="nx">beforeHook</span><span class="p">);</span>
<span class="nx">hook</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="nx">afterHook</span><span class="p">);</span>
<span class="nx">hook</span><span class="p">(</span><span class="nx">fetchFromDatabase</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>

<span class="c1">// bad</span>
<span class="nx">hook</span><span class="p">.</span><span class="nx">before</span><span class="p">(</span><span class="dl">"</span><span class="s2">get</span><span class="dl">"</span><span class="p">,</span> <span class="nx">beforeHook</span><span class="p">);</span>
<span class="nx">hook</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="dl">"</span><span class="s2">get</span><span class="dl">"</span><span class="p">,</span> <span class="nx">afterHook</span><span class="p">);</span>
<span class="nx">hook</span><span class="p">(</span><span class="dl">"</span><span class="s2">get</span><span class="dl">"</span><span class="p">,</span> <span class="nx">fetchFromDatabase</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="hook-collection-api">Hook collection API</h2>

<ul>
  <li><a href="#collection-constructor">Collection constructor</a></li>
  <li><a href="#hookcollectionapi">hookCollection.api</a></li>
  <li><a href="#hookcollection">hookCollection()</a></li>
  <li><a href="#hookcollectionbefore">hookCollection.before()</a></li>
  <li><a href="#hookcollectionerror">hookCollection.error()</a></li>
  <li><a href="#hookcollectionafter">hookCollection.after()</a></li>
  <li><a href="#hookcollectionwrap">hookCollection.wrap()</a></li>
  <li><a href="#hookcollectionremove">hookCollection.remove()</a></li>
</ul>

<h3 id="collection-constructor">Collection constructor</h3>

<p>The <code class="language-plaintext highlighter-rouge">Hook.Collection</code> constructor has no options and returns a <code class="language-plaintext highlighter-rouge">hookCollection</code> instance with the
methods below</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">hookCollection</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hook</span><span class="p">.</span><span class="nx">Collection</span><span class="p">();</span>
</code></pre></div></div>

<h3 id="hookcollectionapi">hookCollection.api</h3>

<p>Use the <code class="language-plaintext highlighter-rouge">api</code> property to return the public API:</p>

<ul>
  <li><a href="#hookcollectionbefore">hookCollection.before()</a></li>
  <li><a href="#hookcollectionafter">hookCollection.after()</a></li>
  <li><a href="#hookcollectionerror">hookCollection.error()</a></li>
  <li><a href="#hookcollectionwrap">hookCollection.wrap()</a></li>
  <li><a href="#hookcollectionremove">hookCollection.remove()</a></li>
</ul>

<p>That way you don’t need to expose the <a href="#hookcollection">hookCollection()</a> method to consumers of your library</p>

<h3 id="hookcollection">hookCollection()</h3>

<p>Invoke before and after hooks. Returns a promise.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">hookCollection</span><span class="p">(</span><span class="nx">nameOrNames</span><span class="p">,</span> <span class="nx">method</span> <span class="cm">/*, options */</span><span class="p">);</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Argument</th>
      <th>Type</th>
      <th>Description</th>
      <th>Required</th>
    </tr>
  </thead>
  <tr>
    <th align="left"><code>name</code></th>
    <td>String or Array of Strings</td>
    <td>Hook name, for example <code>'save'</code>. Or an array of names, see example below.</td>
    <td>Yes</td>
  </tr>
  <tr>
    <th align="left"><code>method</code></th>
    <td>Function</td>
    <td>Callback to be executed after all before hooks finished execution successfully. <code>options</code> is passed as first argument</td>
    <td>Yes</td>
  </tr>
  <tr>
    <th align="left"><code>options</code></th>
    <td>Object</td>
    <td>Will be passed to all before hooks as reference, so they can mutate it</td>
    <td>No, defaults to empty object (<code>{}</code>)</td>
  </tr>
</table>

<p>Resolves with whatever <code class="language-plaintext highlighter-rouge">method</code> returns or resolves with.
Rejects with error that is thrown or rejected with by</p>

<ol>
  <li>Any of the before hooks, whichever rejects / throws first</li>
  <li><code class="language-plaintext highlighter-rouge">method</code></li>
  <li>Any of the after hooks, whichever rejects / throws first</li>
</ol>

<p>Simple Example</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">hookCollection</span><span class="p">(</span>
  <span class="dl">"</span><span class="s2">save</span><span class="dl">"</span><span class="p">,</span>
  <span class="kd">function</span> <span class="p">(</span><span class="nx">record</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">store</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nx">record</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">record</span>
<span class="p">);</span>
<span class="c1">// shorter:  hookCollection('save', store.save, record)</span>

<span class="nx">hookCollection</span><span class="p">.</span><span class="nx">before</span><span class="p">(</span><span class="dl">"</span><span class="s2">save</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">addTimestamps</span><span class="p">(</span><span class="nx">record</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">record</span><span class="p">.</span><span class="nx">createdAt</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">record</span><span class="p">.</span><span class="nx">updatedAt</span> <span class="o">=</span> <span class="nx">now</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">record</span><span class="p">.</span><span class="nx">createdAt</span> <span class="o">=</span> <span class="nx">now</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<p>Example defining multiple hooks at once.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">hookCollection</span><span class="p">(</span>
  <span class="p">[</span><span class="dl">"</span><span class="s2">add</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">save</span><span class="dl">"</span><span class="p">],</span>
  <span class="kd">function</span> <span class="p">(</span><span class="nx">record</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">store</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nx">record</span><span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">record</span>
<span class="p">);</span>

<span class="nx">hookCollection</span><span class="p">.</span><span class="nx">before</span><span class="p">(</span><span class="dl">"</span><span class="s2">add</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">addTimestamps</span><span class="p">(</span><span class="nx">record</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">record</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">type property is required</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">hookCollection</span><span class="p">.</span><span class="nx">before</span><span class="p">(</span><span class="dl">"</span><span class="s2">save</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">addTimestamps</span><span class="p">(</span><span class="nx">record</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">record</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">type property is required</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<p>Defining multiple hooks is helpful if you have similar methods for which you want to define separate hooks, but also an additional hook that gets called for all at once. The example above is equal to this:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">hookCollection</span><span class="p">(</span>
  <span class="dl">"</span><span class="s2">add</span><span class="dl">"</span><span class="p">,</span>
  <span class="kd">function</span> <span class="p">(</span><span class="nx">record</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">hookCollection</span><span class="p">(</span>
      <span class="dl">"</span><span class="s2">save</span><span class="dl">"</span><span class="p">,</span>
      <span class="kd">function</span> <span class="p">(</span><span class="nx">record</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">store</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="nx">record</span><span class="p">);</span>
      <span class="p">},</span>
      <span class="nx">record</span>
    <span class="p">);</span>
  <span class="p">},</span>
  <span class="nx">record</span>
<span class="p">);</span>
</code></pre></div></div>

<h3 id="hookcollectionbefore">hookCollection.before()</h3>

<p>Add before hook for given name.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">hookCollection</span><span class="p">.</span><span class="nx">before</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">method</span><span class="p">);</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Argument</th>
      <th>Type</th>
      <th>Description</th>
      <th>Required</th>
    </tr>
  </thead>
  <tr>
    <th align="left"><code>name</code></th>
    <td>String</td>
    <td>Hook name, for example <code>'save'</code></td>
    <td>Yes</td>
  </tr>
  <tr>
    <th align="left"><code>method</code></th>
    <td>Function</td>
    <td>
      Executed before the wrapped method. Called with the hook’s
      <code>options</code> argument. Before hooks can mutate the passed options
      before they are passed to the wrapped method.
    </td>
    <td>Yes</td>
  </tr>
</table>

<p>Example</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">hookCollection</span><span class="p">.</span><span class="nx">before</span><span class="p">(</span><span class="dl">"</span><span class="s2">save</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">validate</span><span class="p">(</span><span class="nx">record</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">record</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">name property is required</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="hookcollectionerror">hookCollection.error()</h3>

<p>Add error hook for given name.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">hookCollection</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">method</span><span class="p">);</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Argument</th>
      <th>Type</th>
      <th>Description</th>
      <th>Required</th>
    </tr>
  </thead>
  <tr>
    <th align="left"><code>name</code></th>
    <td>String</td>
    <td>Hook name, for example <code>'save'</code></td>
    <td>Yes</td>
  </tr>
  <tr>
    <th align="left"><code>method</code></th>
    <td>Function</td>
    <td>
      Executed when an error occurred in either the wrapped method or a
      <code>before</code> hook. Called with the thrown <code>error</code>
      and the hook’s <code>options</code> argument. The first <code>method</code>
      which does not throw an error will set the result that the after hook
      methods will receive.
    </td>
    <td>Yes</td>
  </tr>
</table>

<p>Example</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">hookCollection</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">"</span><span class="s2">save</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">ignore</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
  <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="hookcollectionafter">hookCollection.after()</h3>

<p>Add after hook for given name.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">hookCollection</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">method</span><span class="p">);</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Argument</th>
      <th>Type</th>
      <th>Description</th>
      <th>Required</th>
    </tr>
  </thead>
  <tr>
    <th align="left"><code>name</code></th>
    <td>String</td>
    <td>Hook name, for example <code>'save'</code></td>
    <td>Yes</td>
  </tr>
  <tr>
    <th align="left"><code>method</code></th>
    <td>Function</td>
    <td>
    Executed after wrapped method. Called with what the wrapped method
    resolves with the hook’s <code>options</code> argument.
    </td>
    <td>Yes</td>
  </tr>
</table>

<p>Example</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">hookCollection</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="dl">"</span><span class="s2">save</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">updatedAt</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">app</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="dl">"</span><span class="s2">update</span><span class="dl">"</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">app</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="dl">"</span><span class="s2">create</span><span class="dl">"</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="hookcollectionwrap">hookCollection.wrap()</h3>

<p>Add wrap hook for given name.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">hookCollection</span><span class="p">.</span><span class="nx">wrap</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">method</span><span class="p">);</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Argument</th>
      <th>Type</th>
      <th>Description</th>
      <th>Required</th>
    </tr>
  </thead>
  <tr>
    <th align="left"><code>name</code></th>
    <td>String</td>
    <td>Hook name, for example <code>'save'</code></td>
    <td>Yes</td>
  </tr>
  <tr>
    <th align="left"><code>method</code></th>
    <td>Function</td>
    <td>
      Receives both the wrapped method and the passed options as arguments so it can add logic before and after the wrapped method, it can handle errors and even replace the wrapped method altogether
    </td>
    <td>Yes</td>
  </tr>
</table>

<p>Example</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">hookCollection</span><span class="p">.</span><span class="nx">wrap</span><span class="p">(</span><span class="dl">"</span><span class="s2">save</span><span class="dl">"</span><span class="p">,</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">saveInDatabase</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">record</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">name property is required</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">saveInDatabase</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">updatedAt</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">app</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="dl">"</span><span class="s2">update</span><span class="dl">"</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">app</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="dl">"</span><span class="s2">create</span><span class="dl">"</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">ignore</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
    <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<p>See also: <a href="examples/test-mock-example.md">Test mock example</a></p>

<h3 id="hookcollectionremove">hookCollection.remove()</h3>

<p>Removes hook for given name.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">hookCollection</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">hookMethod</span><span class="p">);</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Argument</th>
      <th>Type</th>
      <th>Description</th>
      <th>Required</th>
    </tr>
  </thead>
  <tr>
    <th align="left"><code>name</code></th>
    <td>String</td>
    <td>Hook name, for example <code>'save'</code></td>
    <td>Yes</td>
  </tr>
  <tr>
    <th align="left"><code>beforeHookMethod</code></th>
    <td>Function</td>
    <td>
      Same function that was previously passed to <code>hookCollection.before()</code>, <code>hookCollection.error()</code>, <code>hookCollection.after()</code> or <code>hookCollection.wrap()</code>
    </td>
    <td>Yes</td>
  </tr>
</table>

<p>Example</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">hookCollection</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="dl">"</span><span class="s2">save</span><span class="dl">"</span><span class="p">,</span> <span class="nx">validateRecord</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="typescript">TypeScript</h2>

<p>This library contains type definitions for TypeScript.</p>

<h3 id="type-support-for-singular">Type support for <code class="language-plaintext highlighter-rouge">Singular</code>:</h3>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Hook</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">before-after-hook</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">type</span> <span class="nx">TOptions</span> <span class="o">=</span> <span class="p">{</span> <span class="na">foo</span><span class="p">:</span> <span class="kr">string</span> <span class="p">};</span> <span class="c1">// type for options</span>
<span class="kd">type</span> <span class="nx">TResult</span> <span class="o">=</span> <span class="p">{</span> <span class="na">bar</span><span class="p">:</span> <span class="kr">number</span> <span class="p">};</span> <span class="c1">// type for result</span>
<span class="kd">type</span> <span class="nx">TError</span> <span class="o">=</span> <span class="nb">Error</span><span class="p">;</span> <span class="c1">// type for error</span>

<span class="kd">const</span> <span class="nx">hook</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hook</span><span class="p">.</span><span class="nx">Singular</span><span class="o">&lt;</span><span class="nx">TOptions</span><span class="p">,</span> <span class="nx">TResult</span><span class="p">,</span> <span class="nx">TError</span><span class="o">&gt;</span><span class="p">();</span>

<span class="nx">hook</span><span class="p">.</span><span class="nx">before</span><span class="p">((</span><span class="nx">options</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// `options.foo` has `string` type</span>

  <span class="c1">// not allowed</span>
  <span class="nx">options</span><span class="p">.</span><span class="nx">foo</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>

  <span class="c1">// allowed</span>
  <span class="nx">options</span><span class="p">.</span><span class="nx">foo</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Forty-Two</span><span class="dl">"</span><span class="p">;</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">hookedMethod</span> <span class="o">=</span> <span class="nx">hook</span><span class="p">(</span>
  <span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// `options.foo` has `string` type</span>

    <span class="c1">// not allowed, because it does not satisfy the `R` type</span>
    <span class="k">return</span> <span class="p">{</span> <span class="na">foo</span><span class="p">:</span> <span class="mi">42</span> <span class="p">};</span>

    <span class="c1">// allowed</span>
    <span class="k">return</span> <span class="p">{</span> <span class="na">bar</span><span class="p">:</span> <span class="mi">42</span> <span class="p">};</span>
  <span class="p">},</span>
  <span class="p">{</span> <span class="na">foo</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Forty-Two</span><span class="dl">"</span> <span class="p">}</span>
<span class="p">);</span>
</code></pre></div></div>

<p>You can choose not to pass the types for options, result or error. So, these are completely valid:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">hook</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hook</span><span class="p">.</span><span class="nx">Singular</span><span class="o">&lt;</span><span class="nx">O</span><span class="p">,</span> <span class="nx">R</span><span class="o">&gt;</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">hook</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hook</span><span class="p">.</span><span class="nx">Singular</span><span class="o">&lt;</span><span class="nx">O</span><span class="o">&gt;</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">hook</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hook</span><span class="p">.</span><span class="nx">Singular</span><span class="p">();</span>
</code></pre></div></div>

<p>In these cases, the omitted types will implicitly be <code class="language-plaintext highlighter-rouge">any</code>.</p>

<h3 id="type-support-for-collection">Type support for <code class="language-plaintext highlighter-rouge">Collection</code>:</h3>

<p><code class="language-plaintext highlighter-rouge">Collection</code> also has strict type support. You can use it like this:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Hook</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">before-after-hook</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">type</span> <span class="nx">HooksType</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">add</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">Options</span><span class="p">:</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="kr">string</span> <span class="p">};</span>
    <span class="nl">Result</span><span class="p">:</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="kr">number</span> <span class="p">};</span>
    <span class="nl">Error</span><span class="p">:</span> <span class="nb">Error</span><span class="p">;</span>
  <span class="p">};</span>
  <span class="nl">save</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">Options</span><span class="p">:</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="kr">string</span> <span class="p">};</span>
    <span class="nl">Result</span><span class="p">:</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="kr">number</span> <span class="p">};</span>
  <span class="p">};</span>
  <span class="nl">read</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">Options</span><span class="p">:</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span> <span class="nl">foo</span><span class="p">:</span> <span class="kr">number</span> <span class="p">};</span>
  <span class="p">};</span>
  <span class="nl">destroy</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">Options</span><span class="p">:</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span> <span class="nl">foo</span><span class="p">:</span> <span class="kr">string</span> <span class="p">};</span>
  <span class="p">};</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">hooks</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hook</span><span class="p">.</span><span class="nx">Collection</span><span class="o">&lt;</span><span class="nx">HooksType</span><span class="o">&gt;</span><span class="p">();</span>

<span class="nx">hooks</span><span class="p">.</span><span class="nx">before</span><span class="p">(</span><span class="dl">"</span><span class="s2">destroy</span><span class="dl">"</span><span class="p">,</span> <span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// `options.id` has `number` type</span>
<span class="p">});</span>

<span class="nx">hooks</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">"</span><span class="s2">add</span><span class="dl">"</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// `options.type` has `string` type</span>
  <span class="c1">// `err` is `instanceof Error`</span>
<span class="p">});</span>

<span class="nx">hooks</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">"</span><span class="s2">save</span><span class="dl">"</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// `options.type` has `string` type</span>
  <span class="c1">// `err` has type `any`</span>
<span class="p">});</span>

<span class="nx">hooks</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="dl">"</span><span class="s2">save</span><span class="dl">"</span><span class="p">,</span> <span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// `options.type` has `string` type</span>
  <span class="c1">// `result.id` has `number` type</span>
<span class="p">});</span>
</code></pre></div></div>

<p>You can choose not to pass the types altogether. In that case, everything will implicitly be <code class="language-plaintext highlighter-rouge">any</code>:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">hook</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hook</span><span class="p">.</span><span class="nx">Collection</span><span class="p">();</span>
</code></pre></div></div>

<p>Alternative imports:</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">Singular</span><span class="p">,</span> <span class="nx">Collection</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">before-after-hook</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">hook</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Singular</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">hooks</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Collection</span><span class="p">();</span>
</code></pre></div></div>

<h2 id="upgrading-to-14">Upgrading to 1.4</h2>

<p>Since version 1.4 the <code class="language-plaintext highlighter-rouge">Hook</code> constructor has been deprecated in favor of returning <code class="language-plaintext highlighter-rouge">Hook.Singular</code> in an upcoming breaking release.</p>

<p>Version 1.4 is still 100% backwards-compatible, but if you want to continue using hook collections, we recommend using the <code class="language-plaintext highlighter-rouge">Hook.Collection</code> constructor instead before the next release.</p>

<p>For even more details, check out <a href="https://github.com/gr2m/before-after-hook/pull/52">the PR</a>.</p>

<h2 id="see-also">See also</h2>

<p>If <code class="language-plaintext highlighter-rouge">before-after-hook</code> is not for you, have a look at one of these alternatives:</p>

<ul>
  <li>https://github.com/keystonejs/grappling-hook</li>
  <li>https://github.com/sebelga/promised-hooks</li>
  <li>https://github.com/bnoguchi/hooks-js</li>
  <li>https://github.com/cb1kenobi/hook-emitter</li>
</ul>

<h2 id="license">License</h2>

<p><a href="/hello-js-action-alu0100901214/node_modules/before-after-hook/LICENSE">Apache 2.0</a></p>


      </section>

    </div>

    
  </body>
</html>
